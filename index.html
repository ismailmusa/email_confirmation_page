import express from "express";
import path from "path";
import { fileURLToPath } from "url";

const app = express();
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Serve static files (like CSS, images if you add them later)
app.use(express.static(path.join(__dirname, "public")));

// Email confirmation route
app.get("/confirm-email", (req, res) => {
  const { user, email } = req.query;
  const loginUrl = "/dashboard";
  const supportEmail = "support@danhausa.com";

  // Inject values into HTML
  res.send(`
  <!doctype html>
  <html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Email Confirmed â€” DanHausa Logistics</title>
    <style>
      :root{
        --bg:#f4f7fb;
        --card:#ffffff;
        --primary:#0b62a4;
        --accent:#0b8a5f;
        --muted:#6b7280;
        --radius:16px;
      }
      *{box-sizing:border-box;margin:0;padding:0;}
      body{
        font-family: 'Inter', system-ui, sans-serif;
        background:var(--bg);
        color:#0f1724;
        min-height:100vh;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        padding:24px;
      }
      .container{
        width:100%;
        max-width:520px;
        background:var(--card);
        border-radius:var(--radius);
        box-shadow:0 6px 30px rgba(0,0,0,0.08);
        padding:32px 26px;
        text-align:center;
        animation:fadeIn 0.7s ease;
      }
      @keyframes fadeIn{ from{opacity:0;transform:translateY(20px);} to{opacity:1;transform:translateY(0);} }
      .logo{
        font-size:26px;
        font-weight:800;
        background:linear-gradient(90deg,var(--primary),var(--accent));
        -webkit-background-clip:text;
        color:transparent;
        margin-bottom:8px;
      }
      h1{
        font-size:22px;
        margin-bottom:10px;
        color:var(--primary);
      }
      p{
        font-size:15px;
        color:#374151;
        line-height:1.6;
        margin-bottom:16px;
      }
      .check{
        width:82px;height:82px;
        border-radius:50%;
        background:linear-gradient(145deg,#e6fbef,#f0f9ff);
        display:flex;align-items:center;justify-content:center;
        margin:0 auto 18px;
      }
      .check svg{ width:46px; height:46px; }
      .btn{
        display:inline-block;
        padding:12px 20px;
        border-radius:10px;
        background:var(--primary);
        color:#fff;
        font-weight:600;
        text-decoration:none;
        margin-top:14px;
        transition:0.3s ease;
      }
      .btn:hover{ background:var(--accent); }
      footer{
        margin-top:22px;
        font-size:13px;
        color:var(--muted);
      }
      @media(max-width:480px){
        .container{padding:26px 20px;}
        h1{font-size:20px;}
        p{font-size:14px;}
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="check">
        <svg viewBox="0 0 24 24" fill="none" stroke="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="11" fill="#e6fbef"/>
          <path d="M7 12.5l2.8 2.5L17 8.5" stroke="#0b8a5f" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="logo">DanHausa Logistics</div>
      <h1>Email Confirmed ðŸŽ‰</h1>
      <p>Hi <strong>${user || "Customer"}</strong>, your email <strong>${email || ""}</strong> has been successfully verified.<br/>
      Your account is now active â€” you can log in and start booking deliveries.</p>
      <a href="${loginUrl}" class="btn">Go to Dashboard</a>
      <footer>Need help? Contact <a href="mailto:${supportEmail}" style="color:var(--primary);text-decoration:none;">${supportEmail}</a></footer>
    </div>
  </body>
  </html>
  `);
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => console.log(`âœ… Server running on http://localhost:${PORT}`));
